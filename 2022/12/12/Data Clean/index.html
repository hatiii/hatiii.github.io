<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Data clean | 鼠鼠之家</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="​    包括数据大小规模等基本信息的查看，数据格式查看，数据是否存在缺失数据，数据缺失值的填充处理，重复数据的检测与处理，异常数据的检测与处理等。 第一节 熟悉数据1.怎么查看数据信息【解】利用pthon的info（）函数可以查看索引dtype和列dtype，非空值和内存使用情况 123import pandas as pddf &#x3D; pd.read_csv(&amp;#x27;d:&#x2F;大数据&#x2F;items&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="Data clean">
<meta property="og:url" content="https://hatiii.github.io/2022/12/12/Data%20Clean/index.html">
<meta property="og:site_name" content="鼠鼠之家">
<meta property="og:description" content="​    包括数据大小规模等基本信息的查看，数据格式查看，数据是否存在缺失数据，数据缺失值的填充处理，重复数据的检测与处理，异常数据的检测与处理等。 第一节 熟悉数据1.怎么查看数据信息【解】利用pthon的info（）函数可以查看索引dtype和列dtype，非空值和内存使用情况 123import pandas as pddf &#x3D; pd.read_csv(&amp;#x27;d:&#x2F;大数据&#x2F;items&#x2F;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="c:/Users/A/AppData/Roaming/Typora/typora-user-images/image-20221015220108036.png">
<meta property="og:image" content="c:/Users/A/AppData/Roaming/Typora/typora-user-images/image-20221015220755815.png">
<meta property="article:published_time" content="2022-12-12T07:16:46.000Z">
<meta property="article:modified_time" content="2022-12-12T07:24:24.857Z">
<meta property="article:author" content="哈提">
<meta property="article:tag" content="data science">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:/Users/A/AppData/Roaming/Typora/typora-user-images/image-20221015220108036.png">
  
    <link rel="alternate" href="/atom.xml" title="鼠鼠之家" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">鼠鼠之家</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://hatiii.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Data Clean" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/12/12/Data%20Clean/" class="article-date">
  <time datetime="2022-12-12T07:16:46.000Z" itemprop="datePublished">2022-12-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Data clean
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>​    包括数据大小规模等基本信息的查看，数据格式查看，数据是否存在缺失数据，数据缺失值的填充处理，重复数据的检测与处理，异常数据的检测与处理等。</p>
<h3 id="第一节-熟悉数据"><a href="#第一节-熟悉数据" class="headerlink" title="第一节 熟悉数据"></a>第一节 熟悉数据</h3><h5 id="1-怎么查看数据信息"><a href="#1-怎么查看数据信息" class="headerlink" title="1.怎么查看数据信息"></a>1.怎么查看数据信息</h5><p>【解】利用pthon的info（）函数可以查看索引dtype和列dtype，非空值和内存使用情况</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;d:/大数据/items/10-14.csv&#x27;</span>,encoding=<span class="string">&#x27;gbk&#x27;</span>)</span><br><span class="line">df.info()</span><br></pre></td></tr></table></figure>

<p>显示的数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;pandas.core.frame.DataFrame&#x27;</span>&gt;</span><br><span class="line">Index: <span class="number">0</span> entries</span><br><span class="line">Data columns (total <span class="number">4</span> columns):</span><br><span class="line"> <span class="comment">#   Column               Non-Null Count  Dtype </span></span><br><span class="line">---  ------               --------------  ----- </span><br><span class="line"> <span class="number">0</span>   [&#123;<span class="string">&quot;id&quot;</span>: <span class="string">&quot;4&quot;</span>          <span class="number">0</span> non-null      <span class="built_in">object</span></span><br><span class="line"> <span class="number">1</span>    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;baidu&quot;</span>     <span class="number">0</span> non-null      <span class="built_in">object</span></span><br><span class="line"> <span class="number">2</span>    <span class="string">&quot;url&quot;</span>: <span class="string">&quot;zhizhi&quot;</span>     <span class="number">0</span> non-null      <span class="built_in">object</span></span><br><span class="line"> <span class="number">3</span>    <span class="string">&quot;like&quot;</span>: <span class="string">&quot;shushu&quot;</span>&#125;]  <span class="number">0</span> non-null      <span class="built_in">object</span></span><br><span class="line">dtypes: <span class="built_in">object</span>(<span class="number">4</span>)</span><br><span class="line">memory usage: <span class="number">0.0</span>+ <span class="built_in">bytes</span></span><br></pre></td></tr></table></figure>

<h5 id="2-查看数据表的大小"><a href="#2-查看数据表的大小" class="headerlink" title="2.查看数据表的大小"></a>2.查看数据表的大小</h5><p>【例】对于给定的数据库test_database.sqlite,已知数据库中有表格sales_table,请利用python查看数据表的大小。</p>
<p>【解】可以<strong>利用shape属性</strong>查看数据表例各维度的大小，程序代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">with</span> sqlite3.connect(<span class="string">r&#x27;d:/sqlite1/test.db&#x27;</span>)<span class="keyword">as</span> con:</span><br><span class="line">    df = pd.read_sql_query(<span class="string">&quot;SELECT * FROM COMPANY&quot;</span>,con=con)</span><br><span class="line"><span class="built_in">print</span>(df.shape)<span class="comment">##关键代码</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><em>pandas调用数据库主要有read_sql_table，read_sql_query，read_sql三种方式。</em></p>
<table>
<thead>
<tr>
<th>方法</th>
<th>功能</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>read_sql_table</td>
<td>读取数据库中的表，返回dataframe</td>
<td></td>
</tr>
<tr>
<td>read_sql_query</td>
<td>读取sql查询脚本,返回dataframe。也可增删改</td>
<td>日常工作主要是查询的建议使用这个</td>
</tr>
<tr>
<td>read_sql</td>
<td>读取表或脚本，返回dataframe</td>
<td>虽然read_sql综合了以上两者的功能但在实际生产中并不建议使用。因为该函数会先去查询你的语句是否为一个表，造成资源浪费</td>
</tr>
</tbody></table>
<h5 id="3、数据格式查看"><a href="#3、数据格式查看" class="headerlink" title="3、数据格式查看"></a>3、数据格式查看</h5><p>【例】对于给定的数据文件，数据的生成机制和数据形式如下所示，现假定我们不知道数据的生成类型，请利用pytho查看现有的数据框类型还说数组矩阵类型。</p>
<p>【解】可以用type函数来查看数据类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">df = pd.DataFrame(np.random.randint(<span class="number">6</span>,<span class="number">10</span>,size=(<span class="number">10</span>,<span class="number">3</span>)),columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">Array = np.random.randint(<span class="number">6</span>,<span class="number">10</span>,size=(<span class="number">10</span>,<span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(Array)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(df))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(Array))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>【例】利用python查看数据格式是字符串还是数字格式。</p>
<p>【解】对于series数据可以用dtype查看，对于dataframe数据可以用dtypes查看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">df = pd.DataFrame(np.random.randint(<span class="number">6</span>,<span class="number">10</span>,size=(<span class="number">10</span>,<span class="number">3</span>)),columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"></span><br><span class="line">Array = np.random.randint(<span class="number">6</span>,<span class="number">10</span>,size=(<span class="number">10</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Array.dtype)</span><br><span class="line"><span class="built_in">print</span>(df.dtypes)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>显示的结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">int32</span><br><span class="line">a    int32</span><br><span class="line">b    int32</span><br><span class="line">c    int32</span><br><span class="line">dtype: <span class="built_in">object</span></span><br></pre></td></tr></table></figure>



<h5 id="4-查看数据分布"><a href="#4-查看数据分布" class="headerlink" title="4.查看数据分布"></a>4.查看数据分布</h5><p>【例】请根据给定如下形式的数据，对数据的分布进行初步分析，包括统计数据中各元素的个数，均值，方差，最小值，最大值和分位数。</p>
<p>【解】在做数据分析时，常常需要了解数据元素的特征，describe()函数可以用于描述数据统计量特征</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">d = &#123;<span class="string">&#x27;one&#x27;</span>:pd.Series([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]),<span class="string">&#x27;two&#x27;</span>:pd.Series([<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]),<span class="string">&#x27;three&#x27;</span>:pd.Series([-<span class="number">1</span>,-<span class="number">2</span>,-<span class="number">3</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>])&#125;</span><br><span class="line">df=pd.DataFrame(d)</span><br><span class="line"><span class="built_in">print</span>(df.describe())</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>【例】google公司提供了1990年人口普查中加利福尼亚州的所有截取组收集了有关变量的信息。在这个样本中，一个街区组平均包括1425.5个人生活在一个地理紧凑的区域。自然，所包括的地理区域与人口密度成反比。该数据计算了以纬度和精度测量的每个块组的质心之间的距离。并且排除了所有报告自变量和因变量的零条目的块组。最终数据集包含对9个特征（经度，维度，住房房龄，房屋卧室数，居住地人口数，房屋居住人数，收入，房屋价值）的20640个观测值。数据集为存储在d盘的California_housing_train文件，数据集的前10行数据形式如下，请利用python查看数据的基本分布特征。</p>
<p>【解】在做数据分析时，常常需要了解数据元素的特征，describe()函数可以用于描述数据统计量特征，其中：count表述数据含量，mean表示数据平均值，std表示数据的标准差（<em>概念 1、均方差就是标准差,标准差就是均方差 2、方差是各数据偏离平均值差值的平方和 的平均数 3、均方误差(MSE)是各数据偏离真实值差值的平方和 的平均数 4、方差是平均值,均方误差是真实值。</em>），min表示数据的最小值，max表示数据的最大值，25%，50%，75%分别表述数据的一分位，二分位，三分位数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">california_df = pd.read_csv(<span class="string">&quot;d:/大数据/items/10-5.csv&quot;</span>,sep=<span class="string">&#x27;,&#x27;</span>,encoding=<span class="string">&quot;gbk&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(california_df.describe())</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="第二节-缺失值处理"><a href="#第二节-缺失值处理" class="headerlink" title="第二节 缺失值处理"></a>第二节 缺失值处理</h3><ul>
<li>缺失值检查</li>
<li>缺失值删除</li>
<li>缺失值替换、填充</li>
</ul>
<h5 id="一、缺失值检查"><a href="#一、缺失值检查" class="headerlink" title="一、缺失值检查"></a>一、缺失值检查</h5><p>【例】若某程序员对淘宝网站爬虫后得到原始数据集items.csv，文件内容形式如下所示：nan表示缺失值，请利用python检查各列缺失数据的个数，并汇总</p>
<p>【解】python提供了对数据进行缺失检测的方法isnull（）。isnull函数返回值为布尔值，缺失返回True，没有确实返回False。isnull().any()来具体判断哪些列包含缺失值，该列缺失返回True。isnull().sum()查看每列缺失值的数量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">california_df = pd.read_csv(<span class="string">&quot;d:/大数据/items/10-5.csv&quot;</span>,sep=<span class="string">&#x27;,&#x27;</span>,encoding=<span class="string">&quot;gbk&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(california_df.describe())</span><br><span class="line"></span><br><span class="line"><span class="comment">##结果：</span></span><br><span class="line">   item1  item2  item3  item4</span><br><span class="line"><span class="number">0</span>   <span class="literal">True</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">1</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">2</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span></span><br><span class="line"><span class="number">3</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span></span><br><span class="line"><span class="number">4</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span>   <span class="literal">True</span></span><br><span class="line">item1    <span class="number">1</span></span><br><span class="line">item2    <span class="number">0</span></span><br><span class="line">item3    <span class="number">2</span></span><br><span class="line">item4    <span class="number">3</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>

<h5 id="二、缺失值删除"><a href="#二、缺失值删除" class="headerlink" title="二、缺失值删除"></a>二、缺失值删除</h5><p>【例】当缺失数据较多，且重要程度不高的时候，可以直接用<strong>dropna()方法删除这些没有价值的数据</strong>。假设对于上述items.csv数据集检查完缺失值后，要对缺失值进行删除处理，请利用python完成工作。</p>
<p>在一行中，有缺失，整行都会删除，直接使用dropna（）会使以上数据清空。</p>
<p>当某行或某列值都为NaN时，才删除整行或整列。这种情况该如何处理？</p>
<p>【解】当设置dropna（）参数how为all时，表示只有当某行或某列值都为NaN时，才删除整行或整列。其中，参数axis默认为0，表示行，axis=1表示列。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;item1&#x27;</span>:[<span class="literal">None</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item2&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item3&#x27;</span>:[<span class="number">1</span>,<span class="literal">None</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="literal">None</span>],<span class="string">&#x27;item4&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>],<span class="string">&#x27;item5&#x27;</span>:[<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df.dropna(how=<span class="string">&#x27;all&#x27;</span>,axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment">##结果</span></span><br><span class="line">   item1  item2  item3  item4 item5</span><br><span class="line"><span class="number">0</span>    NaN      <span class="number">1</span>    <span class="number">1.0</span>    <span class="number">1.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span>      <span class="number">2</span>    NaN    <span class="number">2.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3.0</span>      <span class="number">3</span>    <span class="number">3.0</span>    NaN  <span class="literal">None</span></span><br><span class="line"><span class="number">3</span>    <span class="number">4.0</span>      <span class="number">4</span>    <span class="number">4.0</span>    NaN  <span class="literal">None</span></span><br><span class="line"><span class="number">4</span>    <span class="number">5.0</span>      <span class="number">5</span>    NaN    NaN  <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">   item1  item2  item3  item4</span><br><span class="line"><span class="number">0</span>    NaN      <span class="number">1</span>    <span class="number">1.0</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span>      <span class="number">2</span>    NaN    <span class="number">2.0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3.0</span>      <span class="number">3</span>    <span class="number">3.0</span>    NaN</span><br><span class="line"><span class="number">3</span>    <span class="number">4.0</span>      <span class="number">4</span>    <span class="number">4.0</span>    NaN</span><br><span class="line"><span class="number">4</span>    <span class="number">5.0</span>      <span class="number">5</span>    NaN    NaN</span><br></pre></td></tr></table></figure>



<p>【例】当某行有一个数据为NaN时，就删除整行。遇到这种情况下，该如何处理？</p>
<p>【解】设置dropna()参数how()为any，axis=0时，表明只要某行有一个数据为NaN时，就删除整行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dropna(how=<span class="string">&#x27;any&#x27;</span>,axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>



<p>【例】若使用近邻填补法，即利用缺失值最近邻居的值来填补数据，这种情况该如何实现？</p>
<p>【解】可以将fillna()方法的method参数设置为bfill，来使用缺失值后面的数据进行填充。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;item1&#x27;</span>:[<span class="literal">None</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item2&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item3&#x27;</span>:[<span class="number">1</span>,<span class="literal">None</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="literal">None</span>],<span class="string">&#x27;item4&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>],<span class="string">&#x27;item5&#x27;</span>:[<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df.fillna(method=<span class="string">&#x27;bfill&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment">##结果（bfill，只能填充缺失值所在列的后一个数值，若后一个数值也为空，则寄）</span></span><br><span class="line">   item1  item2  item3  item4 item5</span><br><span class="line"><span class="number">0</span>    NaN      <span class="number">1</span>    <span class="number">1.0</span>    <span class="number">1.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span>      <span class="number">2</span>    NaN    <span class="number">2.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3.0</span>      <span class="number">3</span>    <span class="number">3.0</span>    NaN  <span class="literal">None</span></span><br><span class="line"><span class="number">3</span>    <span class="number">4.0</span>      <span class="number">4</span>    <span class="number">4.0</span>    NaN  <span class="literal">None</span></span><br><span class="line"><span class="number">4</span>    <span class="number">5.0</span>      <span class="number">5</span>    NaN    NaN  <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">   item1  item2  item3  item4 item5</span><br><span class="line"><span class="number">0</span>    <span class="number">2.0</span>      <span class="number">1</span>    <span class="number">1.0</span>    <span class="number">1.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span>      <span class="number">2</span>    <span class="number">3.0</span>    <span class="number">2.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3.0</span>      <span class="number">3</span>    <span class="number">3.0</span>    NaN  <span class="literal">None</span></span><br><span class="line"><span class="number">3</span>    <span class="number">4.0</span>      <span class="number">4</span>    <span class="number">4.0</span>    NaN  <span class="literal">None</span></span><br><span class="line"><span class="number">4</span>    <span class="number">5.0</span>      <span class="number">5</span>    NaN    NaN  <span class="literal">None</span></span><br></pre></td></tr></table></figure>



<p>【例】若使用缺失值前面的值进行填充来填补数据，这种情况又该如何实现？</p>
<p>【解】可以将fillna()方法的method参数设置为ffill，来使用缺失值前面的数值填充。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df.fillna(method=<span class="string">&#x27;ffill&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#结果</span></span><br><span class="line">   item1  item2  item3  item4 item5</span><br><span class="line"><span class="number">0</span>    NaN      <span class="number">1</span>    <span class="number">1.0</span>    <span class="number">1.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span>      <span class="number">2</span>    <span class="number">1.0</span>    <span class="number">2.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3.0</span>      <span class="number">3</span>    <span class="number">3.0</span>    <span class="number">2.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">3</span>    <span class="number">4.0</span>      <span class="number">4</span>    <span class="number">4.0</span>    <span class="number">2.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">4</span>    <span class="number">5.0</span>      <span class="number">5</span>    <span class="number">4.0</span>    <span class="number">2.0</span>  <span class="literal">None</span></span><br></pre></td></tr></table></figure>

<p><em>以下开始难懂</em></p>
<p>【例】常见的插值方法有二次多项式插值法、三次样条插值。在利用python进行插值填补操作时，需要安装scipy库。请使用二次多项式插值法来进行填充，即利用一个二次多项式来逼近原目标函数，然后求解该二次多项式的极小点来作为原目标函数的近似极小点。</p>
<p>【解】可以使用interpolate方法进行二次多项式插值，参数order设置为2，程序代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;item1&#x27;</span>:[<span class="literal">None</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item2&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item3&#x27;</span>:[<span class="number">1</span>,<span class="literal">None</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="literal">None</span>],<span class="string">&#x27;item4&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>],<span class="string">&#x27;item5&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="literal">None</span>,<span class="number">5</span>],<span class="string">&#x27;item6&#x27;</span>:[<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df[<span class="string">&#x27;item5&#x27;</span>].interpolate(method=<span class="string">&quot;polynomial&quot;</span>,order=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment">##结果</span></span><br><span class="line">   item1  item2  item3  item4  item5 item6</span><br><span class="line"><span class="number">0</span>    NaN      <span class="number">1</span>    <span class="number">1.0</span>    <span class="number">1.0</span>    <span class="number">1.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span>      <span class="number">2</span>    NaN    <span class="number">2.0</span>    <span class="number">2.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3.0</span>      <span class="number">3</span>    <span class="number">3.0</span>    NaN    <span class="number">3.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">3</span>    <span class="number">4.0</span>      <span class="number">4</span>    <span class="number">4.0</span>    NaN    NaN  <span class="literal">None</span></span><br><span class="line"><span class="number">4</span>    <span class="number">5.0</span>      <span class="number">5</span>    NaN    NaN    <span class="number">5.0</span>  <span class="literal">None</span></span><br><span class="line"><span class="comment">##使用interpolate后，item5的值</span></span><br><span class="line"><span class="number">0</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3.0</span></span><br><span class="line"><span class="number">3</span>    <span class="number">4.0</span></span><br><span class="line"><span class="number">4</span>    <span class="number">5.0</span></span><br><span class="line">Name: item5, dtype: float64</span><br></pre></td></tr></table></figure>

<p>【例】三次样条插值，即利用一个三次多项式来逼近原目标函数，然后求解该三次多项式的极小点来作为原目标函数的近似极小点。请使用python完成。</p>
<p>【解】可以使用<strong>interpolate方法，order设置为3，method设置为spline</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;item5&#x27;</span>].interpolate(method=<span class="string">&quot;spline&quot;</span>,order=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>





<h3 id="第三节、重复值异常值预处理"><a href="#第三节、重复值异常值预处理" class="headerlink" title="第三节、重复值异常值预处理"></a>第三节、重复值异常值预处理</h3><h5 id="一、发现重复值"><a href="#一、发现重复值" class="headerlink" title="一、发现重复值"></a>一、发现重复值</h5><p>【例】对于items.csv文件，数据形式如下所示，请使用python检查重复值。</p>
<p>【解】python提供了荣誉数据的检测方法duplicated()和去除冗余数据的方法duplicates()。利用duplicated()方法检测荣誉的行或列，默认是判断全部列中的值是否全部重复，并返回布尔类型的结果。对于完全没有重复的行，返回值 为false。对于有重复值的行，第一次出现重复的那一行返回false，其余返回true。检测其是否存在荣誉数据的程序代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;item1&#x27;</span>:[<span class="literal">None</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item2&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item3&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item4&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="literal">None</span>,<span class="number">5</span>],<span class="string">&#x27;item5&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="literal">None</span>,<span class="number">5</span>],<span class="string">&#x27;item6&#x27;</span>:[<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="number">5</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df.duplicated())</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment">#结果</span></span><br><span class="line"><span class="number">0</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">1</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">2</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">3</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">4</span>    <span class="literal">False</span></span><br><span class="line">dtype: <span class="built_in">bool</span></span><br><span class="line">   item1  item2  item3  item4  item5  item6</span><br><span class="line"><span class="number">0</span>    NaN      <span class="number">1</span>      <span class="number">1</span>    <span class="number">1.0</span>    <span class="number">1.0</span>    NaN</span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span>      <span class="number">2</span>      <span class="number">2</span>    <span class="number">2.0</span>    <span class="number">2.0</span>    NaN</span><br><span class="line"><span class="number">2</span>    <span class="number">2.0</span>      <span class="number">2</span>      <span class="number">2</span>    <span class="number">2.0</span>    <span class="number">2.0</span>    NaN</span><br><span class="line"><span class="number">3</span>    <span class="number">4.0</span>      <span class="number">4</span>      <span class="number">4</span>    NaN    NaN    NaN</span><br><span class="line"><span class="number">4</span>    <span class="number">5.0</span>      <span class="number">5</span>      <span class="number">5</span>    <span class="number">5.0</span>    <span class="number">5.0</span>    <span class="number">5.0</span></span><br></pre></td></tr></table></figure>



<h5 id="二、处理重复值"><a href="#二、处理重复值" class="headerlink" title="二、处理重复值"></a>二、处理重复值</h5><p>【例】在上述对items.csv文件检查出重复值的基础上，该如何利用python对重复数据进行删除。</p>
<p>【解】利用duplis（）方法去除冗余数据，即删除冗余的所有行，默认是判断全部列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;item1&#x27;</span>:[<span class="literal">None</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item2&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item3&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;item4&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="literal">None</span>,<span class="number">5</span>],<span class="string">&#x27;item5&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="literal">None</span>,<span class="number">5</span>],<span class="string">&#x27;item6&#x27;</span>:[<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="number">5</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(df.drop_duplicates())</span><br><span class="line"></span><br><span class="line"><span class="comment">#结果</span></span><br><span class="line">   item1  item2  item3  item4  item5  item6</span><br><span class="line"><span class="number">0</span>    NaN      <span class="number">1</span>      <span class="number">1</span>    <span class="number">1.0</span>    <span class="number">1.0</span>    NaN</span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span>      <span class="number">2</span>      <span class="number">2</span>    <span class="number">2.0</span>    <span class="number">2.0</span>    NaN</span><br><span class="line"><span class="number">2</span>    <span class="number">2.0</span>      <span class="number">2</span>      <span class="number">2</span>    <span class="number">2.0</span>    <span class="number">2.0</span>    NaN</span><br><span class="line"><span class="number">3</span>    <span class="number">4.0</span>      <span class="number">4</span>      <span class="number">4</span>    NaN    NaN    NaN</span><br><span class="line"><span class="number">4</span>    <span class="number">5.0</span>      <span class="number">5</span>      <span class="number">5</span>    <span class="number">5.0</span>    <span class="number">5.0</span>    <span class="number">5.0</span></span><br><span class="line">   item1  item2  item3  item4  item5  item6</span><br><span class="line"><span class="number">0</span>    NaN      <span class="number">1</span>      <span class="number">1</span>    <span class="number">1.0</span>    <span class="number">1.0</span>    NaN</span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span>      <span class="number">2</span>      <span class="number">2</span>    <span class="number">2.0</span>    <span class="number">2.0</span>    NaN</span><br><span class="line"><span class="number">3</span>    <span class="number">4.0</span>      <span class="number">4</span>      <span class="number">4</span>    NaN    NaN    NaN</span><br><span class="line"><span class="number">4</span>    <span class="number">5.0</span>      <span class="number">5</span>      <span class="number">5</span>    <span class="number">5.0</span>    <span class="number">5.0</span>    <span class="number">5.0</span></span><br></pre></td></tr></table></figure>

<h3 id="第四节、异常值的检测"><a href="#第四节、异常值的检测" class="headerlink" title="第四节、异常值的检测"></a>第四节、异常值的检测</h3><h5 id="一、检测异常值"><a href="#一、检测异常值" class="headerlink" title="一、检测异常值"></a>一、检测异常值</h5><p>【例】某公司的年度业务数据work.csv，数据形式如下所示：</p>
<table>
<thead>
<tr>
<th>日期</th>
<th>销售</th>
</tr>
</thead>
<tbody><tr>
<td>2010</td>
<td>2342</td>
</tr>
<tr>
<td>…….</td>
<td>……..</td>
</tr>
<tr>
<td>2020</td>
<td>5025</td>
</tr>
</tbody></table>
<p>假定设置条件年度销售量不低于1000，请使用python对数据分析，检测数据是否存在异常值</p>
<p>【解】使用pandas的query方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">df = pd.read_csv(<span class="string">&quot;d:/大数据/items/10-16.csv&quot;</span>,encoding=<span class="string">&#x27;gbk&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df.query(<span class="string">&quot;销售&lt;1000&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#结果</span></span><br><span class="line">     日期    销售</span><br><span class="line"><span class="number">0</span>  <span class="number">2010</span>  <span class="number">1111</span></span><br><span class="line"><span class="number">1</span>  <span class="number">2011</span>  <span class="number">1111</span></span><br><span class="line"><span class="number">2</span>  <span class="number">2012</span>  <span class="number">1111</span></span><br><span class="line"><span class="number">3</span>  <span class="number">2013</span>  <span class="number">1111</span></span><br><span class="line"><span class="number">4</span>  <span class="number">2014</span>  <span class="number">1111</span></span><br><span class="line"><span class="number">5</span>  <span class="number">2015</span>     <span class="number">9</span></span><br><span class="line"><span class="number">6</span>  <span class="number">2016</span>  <span class="number">1111</span></span><br><span class="line"><span class="number">7</span>  <span class="number">2017</span>  <span class="number">1111</span></span><br><span class="line"><span class="number">8</span>  <span class="number">2018</span>  <span class="number">1111</span></span><br><span class="line"></span><br><span class="line">    日期  销售</span><br><span class="line"><span class="number">5</span>  <span class="number">2015</span>   <span class="number">9</span></span><br></pre></td></tr></table></figure>

<p>【解2】用画图的方式检测异常值，同样对于上面公司的数据work.csv，这次通过数据的统计箱型图来观察是否存在异常值用matplotlib的pyplot模块的boxplot()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">df = pd.read_csv(<span class="string">&quot;d:/大数据/items/10-16.csv&quot;</span>,encoding=<span class="string">&#x27;gbk&#x27;</span>)</span><br><span class="line">plt.boxplot(df[<span class="string">&#x27;销售&#x27;</span>])</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="C:\Users\A\AppData\Roaming\Typora\typora-user-images\image-20221015220108036.png" alt="image-20221015220108036"></p>
<h5 id="二、处理异常值"><a href="#二、处理异常值" class="headerlink" title="二、处理异常值"></a>二、处理异常值</h5><p>【例】对于上述业务数据work.csv，若已检测出异常值，请问在此基础上，如何删除异常值？</p>
<p>【解】利用drop（）方法。例如，删除这两个异常点，命令如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">df = pd.read_csv(<span class="string">&quot;d:/大数据/items/10-16.csv&quot;</span>,encoding=<span class="string">&#x27;gbk&#x27;</span>)</span><br><span class="line">df1 = df.drop(index=<span class="number">3</span>,axis=<span class="number">0</span>)</span><br><span class="line">plt.boxplot(df1[<span class="string">&#x27;销售&#x27;</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>结果：<img src="C:\Users\A\AppData\Roaming\Typora\typora-user-images\image-20221015220755815.png" alt="image-20221015220755815"></p>
<h3 id="第五节，数据转换"><a href="#第五节，数据转换" class="headerlink" title="第五节，数据转换"></a>第五节，数据转换</h3><h5 id="一、数据类型检查"><a href="#一、数据类型检查" class="headerlink" title="一、数据类型检查"></a>一、数据类型检查</h5><p>【例】利用arange函数创建一维整数数组，并查看数据类型。</p>
<p>【解】可以通过<strong>dtype属性</strong>来查看数据类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">narr=np.arange(<span class="number">1</span>,<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(narr.dtype)</span><br><span class="line"><span class="comment">##输出结果</span></span><br><span class="line">int32</span><br></pre></td></tr></table></figure>

<h5 id="二、数据类型的转换"><a href="#二、数据类型的转换" class="headerlink" title="二、数据类型的转换"></a>二、数据类型的转换</h5><p>【例】利用<strong>arange函数</strong>创建一维浮点数数组，可以通过<strong>astype函数</strong>对浮点数数据类型强制转换为整数类型。</p>
<p>【解】将数据由float64变换为int32类型。因此，在实际应用中，可以使用astype函数将数据进行强制转换数据类型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">narr = np.arange(<span class="number">1</span>,<span class="number">10</span>,<span class="number">2</span>,dtype=<span class="string">&#x27;float64&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(narr.dtype)</span><br><span class="line"><span class="built_in">print</span>(narr.astype(np.<span class="built_in">int</span>).dtype)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="三、数据类型编码"><a href="#三、数据类型编码" class="headerlink" title="三、数据类型编码"></a>三、数据类型编码</h5><p>【例】假如在对天气数据进行分析时，天气数据包括三个属性，天气、温度和湿度，这三个属性的取值是离散的，分别为：</p>
<p>天气：晴朗、多云、有雨</p>
<p>稳定度：高温、正常</p>
<p>湿度：潮湿、不潮湿</p>
<p>请分别采用普通数字进行编码和独热码（one-hot）进行编码。</p>
<p>【解】若采用<strong>普通数字进行编码</strong>，则天气有三个属性值，分别用0，1，2表示，温度有两个属性，用0，1，表示，湿度用0，1表示。这样，若有一个样本“有雨高温，不潮湿”进行编码，结果会是【2，0，1】。</p>
<p><strong>用独热码</strong>：有雨对应着【0，0，1】，高温对应【1，0】，不潮湿对应着【0，1】。因此，完整的one-hot编码结果为【0，0，1，1，0，0，1】。</p>
<p>【例】现给定原数组结构如下，</p>
<p>[[2,0,1],[1,1,0],[0,1,0],[0,0,1]]。请用python的独热码进行编码设计。</p>
<p>【解】采用python进行数据的one-hot编码，需要安装scikit-learn库。<strong>One-hot编码</strong>，也称独热编码，广泛地应用在数字电路和机器学习领域。这种编码方式是指有多少个状态就采用多少个比特位，且只有一个比特位，其他全为0表示的一种编码机制。如5个状态的one-hot编码为：00001，01000，00100，00010，00001。Python中的sklearn模块提供了one-hot编码方法OneHotEncoder（），可以将原始数据转换为one-hot编码数据，相比Python提供的Map()编码方法，one-hot编码方式可以适用于离散特征的取值是无序关系的数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line">enc = preprocessing.OneHotEncoder()</span><br><span class="line">enc.fit([[<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>]])</span><br><span class="line">array = enc.transform([[<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>]]).toarray()</span><br><span class="line"><span class="built_in">print</span>(array)</span><br><span class="line"><span class="comment">##结果</span></span><br><span class="line">[[<span class="number">0.</span> <span class="number">0.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">0.</span> <span class="number">0.</span> <span class="number">1.</span>]]</span><br></pre></td></tr></table></figure>



<p><em>独热码科普：</em></p>
<ol>
<li><p>One-Hot Encoding（独热码）定义：<br>有多少个状态就有多少比特，而且只有一个比特为1，其他全为0的一种码制。例如，有6个状态的独热码状态编码为：000001，000010，000100，001000，010000，100000。</p>
</li>
<li><p>One-Hot Encoding（独热码）使用：<br>2.1 一个特征feature时热独码<br>在机器学习中，如果我们做的是分类的话，每一个feature（特征）都会有不同的label（标签）。假设我们输入的x是学号，需要输出的feature是班级时，班级一共有三个label，分别是301班，302班，303班。这时如何对这三个班进行数字化表达呢？</p>
</li>
</ol>
<p>最简单的方式就是按照序列来排，301班为0，302班为1，303班为2。这样做有什么问题吗？</p>
<p>在模型训练的过程中不同的值使得同一特征在样本中的权重可能发生变化，比如我把302班的label设为100，就可能比编码成1对模型的的影响更大。为了避免训练过程中因为labe取值对模型产生的负面影响，因此在分类时，最好对label进行独热码编码。也就是说，301班为100，302班为010，303班为001。</p>
<p>2.2 多个特征feature时热独码<br>假设我们输入的x是学号，需要输出的feature有班级和性别，班级有三个label分别是301班302班303班，性别有两个label分别是男和女。这时如何对两个特征进行独热码编码呢？</p>
<p>依次将每个特征的独热码拼接起来。</p>
<p>比如某个x，输出的是302班女生，那么首先将302班按照上面的进行编码得到100，然后按照女进行编码为01，那么两者连接起来得到最后的独热码10001。　</p>
<h3 id="第六节、索引设置（1）"><a href="#第六节、索引设置（1）" class="headerlink" title="第六节、索引设置（1）"></a>第六节、索引设置（1）</h3><h5 id="一、添加索引"><a href="#一、添加索引" class="headerlink" title="一、添加索引"></a>一、添加索引</h5><p>【例】通过数组array创建范围在[1,5]之间的series，并指定索引标签为[‘a’,’b’,’c’,’d’,’e’]。</p>
<p>【解】通过series创建数组，并用index参数添加索引。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">s = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],index = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>



<p>【例】对于某股票交易数据集stock.csv，利用python导入该数据集，默认的数据集索引为数字，请重置索引为日期。</p>
<p>【解】利用pandas库的index_col=‘date’</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">mydata = pd.read_csv(<span class="string">&#x27;d:/大数据/items/10-17.csv&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(mydata)</span><br><span class="line">mydata_1 = pd.read_csv(<span class="string">&#x27;d:/大数据/items/10-17.csv&#x27;</span>,index_col=<span class="string">&#x27;date&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(mydata_1)</span><br><span class="line"></span><br><span class="line"><span class="comment">##结果：</span></span><br><span class="line">    date  <span class="built_in">open</span>  high  close   low  volume  price</span><br><span class="line"><span class="number">0</span>   <span class="number">2010</span>  <span class="number">2010</span>  <span class="number">2010</span>   <span class="number">2010</span>  <span class="number">2010</span>    <span class="number">2010</span>   <span class="number">2010</span></span><br><span class="line"><span class="number">1</span>   <span class="number">2011</span>  <span class="number">2840</span>  <span class="number">2840</span>   <span class="number">2840</span>  <span class="number">2840</span>    <span class="number">2840</span>   <span class="number">2840</span></span><br><span class="line"><span class="number">2</span>   <span class="number">2012</span>  <span class="number">3349</span>  <span class="number">3349</span>   <span class="number">3349</span>  <span class="number">3349</span>    <span class="number">3349</span>   <span class="number">3349</span></span><br><span class="line"><span class="number">3</span>   <span class="number">2013</span>     <span class="number">5</span>     <span class="number">5</span>      <span class="number">5</span>     <span class="number">5</span>       <span class="number">5</span>      <span class="number">5</span></span><br><span class="line"><span class="number">4</span>   <span class="number">2014</span>  <span class="number">5845</span>  <span class="number">5845</span>   <span class="number">5845</span>  <span class="number">5845</span>    <span class="number">5845</span>   <span class="number">5845</span></span><br><span class="line"><span class="number">5</span>   <span class="number">2015</span>  <span class="number">2034</span>  <span class="number">2034</span>   <span class="number">2034</span>  <span class="number">2034</span>    <span class="number">2034</span>   <span class="number">2034</span></span><br><span class="line"><span class="number">6</span>   <span class="number">2016</span>  <span class="number">3021</span>  <span class="number">3021</span>   <span class="number">3021</span>  <span class="number">3021</span>    <span class="number">3021</span>   <span class="number">3021</span></span><br><span class="line"><span class="number">7</span>   <span class="number">2017</span>  <span class="number">2540</span>  <span class="number">2540</span>   <span class="number">2540</span>  <span class="number">2540</span>    <span class="number">2540</span>   <span class="number">2540</span></span><br><span class="line"><span class="number">8</span>   <span class="number">2018</span>  <span class="number">3098</span>  <span class="number">3098</span>   <span class="number">3098</span>  <span class="number">3098</span>    <span class="number">3098</span>   <span class="number">3098</span></span><br><span class="line"><span class="number">9</span>   <span class="number">2019</span>  <span class="number">4410</span>  <span class="number">4410</span>   <span class="number">4410</span>  <span class="number">4410</span>    <span class="number">4410</span>   <span class="number">4410</span></span><br><span class="line"><span class="number">10</span>  <span class="number">2020</span>  <span class="number">5025</span>  <span class="number">5025</span>   <span class="number">5025</span>  <span class="number">5025</span>    <span class="number">5025</span>   <span class="number">5025</span></span><br><span class="line">      <span class="built_in">open</span>  high  close   low  volume  price</span><br><span class="line">date                                        </span><br><span class="line"><span class="number">2010</span>  <span class="number">2010</span>  <span class="number">2010</span>   <span class="number">2010</span>  <span class="number">2010</span>    <span class="number">2010</span>   <span class="number">2010</span></span><br><span class="line"><span class="number">2011</span>  <span class="number">2840</span>  <span class="number">2840</span>   <span class="number">2840</span>  <span class="number">2840</span>    <span class="number">2840</span>   <span class="number">2840</span></span><br><span class="line"><span class="number">2012</span>  <span class="number">3349</span>  <span class="number">3349</span>   <span class="number">3349</span>  <span class="number">3349</span>    <span class="number">3349</span>   <span class="number">3349</span></span><br><span class="line"><span class="number">2013</span>     <span class="number">5</span>     <span class="number">5</span>      <span class="number">5</span>     <span class="number">5</span>       <span class="number">5</span>      <span class="number">5</span></span><br><span class="line"><span class="number">2014</span>  <span class="number">5845</span>  <span class="number">5845</span>   <span class="number">5845</span>  <span class="number">5845</span>    <span class="number">5845</span>   <span class="number">5845</span></span><br><span class="line"><span class="number">2015</span>  <span class="number">2034</span>  <span class="number">2034</span>   <span class="number">2034</span>  <span class="number">2034</span>    <span class="number">2034</span>   <span class="number">2034</span></span><br><span class="line"><span class="number">2016</span>  <span class="number">3021</span>  <span class="number">3021</span>   <span class="number">3021</span>  <span class="number">3021</span>    <span class="number">3021</span>   <span class="number">3021</span></span><br><span class="line"><span class="number">2017</span>  <span class="number">2540</span>  <span class="number">2540</span>   <span class="number">2540</span>  <span class="number">2540</span>    <span class="number">2540</span>   <span class="number">2540</span></span><br><span class="line"><span class="number">2018</span>  <span class="number">3098</span>  <span class="number">3098</span>   <span class="number">3098</span>  <span class="number">3098</span>    <span class="number">3098</span>   <span class="number">3098</span></span><br><span class="line"><span class="number">2019</span>  <span class="number">4410</span>  <span class="number">4410</span>   <span class="number">4410</span>  <span class="number">4410</span>    <span class="number">4410</span>   <span class="number">4410</span></span><br><span class="line"><span class="number">2020</span>  <span class="number">5025</span>  <span class="number">5025</span>   <span class="number">5025</span>  <span class="number">5025</span>    <span class="number">5025</span>   <span class="number">5025</span></span><br></pre></td></tr></table></figure>

<h5 id="二、重命名索引"><a href="#二、重命名索引" class="headerlink" title="二、重命名索引"></a>二、重命名索引</h5><p>【例】通过构建字典来创建一个DataFrame数据实例，形式如下所示，默认的索引是自然数。请利用Python自定义索引标签为’a’,’b’,’c’。</p>
<table>
<thead>
<tr>
<th></th>
<th>one</th>
<th>two</th>
<th>three</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0</td>
<td>zero</td>
<td>0.0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>one</td>
<td>1.0</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>two</td>
<td>2.0</td>
</tr>
</tbody></table>
<p>【解】通过构建字典来创建DataFrame实例，并通过index参数自定义索引标签。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">d = &#123;<span class="string">&#x27;one&#x27;</span>:pd.Series([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]),<span class="string">&#x27;two&#x27;</span>:pd.Series([<span class="string">&#x27;zero&#x27;</span>,<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]),<span class="string">&#x27;three&#x27;</span>:pd.Series([<span class="number">0.0</span>,<span class="number">1.0</span>,<span class="number">2.0</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>])&#125;</span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment">##输出结果</span></span><br><span class="line">   one   two  three</span><br><span class="line">a    <span class="number">0</span>  zero    <span class="number">0.0</span></span><br><span class="line">b    <span class="number">1</span>   one    <span class="number">1.0</span></span><br><span class="line">c    <span class="number">2</span>   two    <span class="number">2.0</span></span><br></pre></td></tr></table></figure>

<p>【例】对于存储在d盘的某门课程的成绩单数据集2021.csv，前10行数据形式如下，<strong>默认的索引值是序号</strong>，请利用”<strong>班级“进行分组</strong>并重置索引。</p>
<p>【解】</p>
<p>groupby([‘班级’])是分组，reset_index()是重置索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">mydata = pd.read_csv(<span class="string">&quot;d:/大数据/items/10-17.csv&quot;</span>,encoding=<span class="string">&#x27;gbk&#x27;</span>,index_col=<span class="string">&quot;序号&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(mydata.head(<span class="number">10</span>))</span><br><span class="line">mydata.groupby([<span class="string">&#x27;班级&#x27;</span>])[<span class="string">&#x27;总成绩&#x27;</span>].<span class="built_in">sum</span>().reset_index()</span><br><span class="line"><span class="comment">##结果</span></span><br><span class="line">班级    学号  考勤成绩  实验成绩  平时成绩  期末成绩   总成绩</span><br><span class="line">序号                                        </span><br><span class="line"><span class="number">1</span>   <span class="number">1</span>班  <span class="number">2010</span>  <span class="number">2010</span>  <span class="number">2010</span>  <span class="number">2010</span>  <span class="number">2010</span>  <span class="number">2010</span></span><br><span class="line"><span class="number">2</span>   <span class="number">2</span>班  <span class="number">2840</span>  <span class="number">2840</span>  <span class="number">2840</span>  <span class="number">2840</span>  <span class="number">2840</span>  <span class="number">2840</span></span><br><span class="line"><span class="number">3</span>   <span class="number">3</span>班  <span class="number">3349</span>  <span class="number">3349</span>  <span class="number">3349</span>  <span class="number">3349</span>  <span class="number">3349</span>  <span class="number">3349</span></span><br><span class="line"><span class="number">4</span>   <span class="number">1</span>班     <span class="number">5</span>     <span class="number">5</span>     <span class="number">5</span>     <span class="number">5</span>     <span class="number">5</span>     <span class="number">5</span></span><br><span class="line"><span class="number">5</span>   <span class="number">2</span>班  <span class="number">5845</span>  <span class="number">5845</span>  <span class="number">5845</span>  <span class="number">5845</span>  <span class="number">5845</span>  <span class="number">5845</span></span><br><span class="line"><span class="number">6</span>   <span class="number">2</span>班  <span class="number">2034</span>  <span class="number">2034</span>  <span class="number">2034</span>  <span class="number">2034</span>  <span class="number">2034</span>  <span class="number">2034</span></span><br><span class="line"><span class="number">7</span>   <span class="number">1</span>班  <span class="number">3021</span>  <span class="number">3021</span>  <span class="number">3021</span>  <span class="number">3021</span>  <span class="number">3021</span>  <span class="number">3021</span></span><br><span class="line"><span class="number">8</span>   <span class="number">2</span>班  <span class="number">2540</span>  <span class="number">2540</span>  <span class="number">2540</span>  <span class="number">2540</span>  <span class="number">2540</span>  <span class="number">2540</span></span><br><span class="line"><span class="number">9</span>   <span class="number">2</span>班  <span class="number">3098</span>  <span class="number">3098</span>  <span class="number">3098</span>  <span class="number">3098</span>  <span class="number">3098</span>  <span class="number">3098</span></span><br><span class="line"><span class="number">10</span>  <span class="number">1</span>班  <span class="number">4410</span>  <span class="number">4410</span>  <span class="number">4410</span>  <span class="number">4410</span>  <span class="number">4410</span>  <span class="number">4410</span></span><br><span class="line"></span><br><span class="line">   班级    总成绩</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span>班   <span class="number">9446</span></span><br><span class="line"><span class="number">1</span>  <span class="number">2</span>班  <span class="number">16357</span></span><br><span class="line"><span class="number">2</span>  <span class="number">3</span>班   <span class="number">3349</span></span><br></pre></td></tr></table></figure>

<h3 id="第七节、其他"><a href="#第七节、其他" class="headerlink" title="第七节、其他"></a>第七节、其他</h3><h5 id="一、数据的大小写转换"><a href="#一、数据的大小写转换" class="headerlink" title="一、数据的大小写转换"></a>一、数据的大小写转换</h5><p>【例】请读取存储在d盘的文档python_intro.txt,形式如下所示，请利用python将其中的内容全部转换为大写形成保存。</p>
<p>【解】可以采用upper()方法，能够将字符串所有字母转换成大写字母。转换完成后，该方法会返回新得到的字符串。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;d:/大数据/items/10-17.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)<span class="keyword">as</span> file:</span><br><span class="line">    s = file.read()</span><br><span class="line">    <span class="built_in">print</span>(s.upper())</span><br><span class="line"><span class="comment">##结果：</span></span><br><span class="line">ZHIZHI WEI ZHIZHI BUZHI WEI BUZHI SHUSHU YE</span><br></pre></td></tr></table></figure>

<p>二、数据修改与替换</p>
<p>【例】对于给定的DataFrame数据，形式如下，利用python增加一列实例数据，和一行实例数据。</p>
<p>【解】df.insert(【index】,【列名】,【列值】)这样插入列</p>
<p>df.loc[‘列名’]=【列值】这样插入行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">d = &#123;<span class="string">&#x27;one&#x27;</span>:pd.Series([<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]),<span class="string">&#x27;two&#x27;</span>:pd.Series([<span class="number">8</span>,<span class="number">10</span>,<span class="number">12</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>])&#125;</span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df.insert(<span class="number">2</span>,<span class="string">&#x27;four&#x27;</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df.loc[<span class="string">&quot;d&quot;</span>]=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment">##结果</span></span><br><span class="line">   one  two</span><br><span class="line">a    <span class="number">0</span>    <span class="number">8</span></span><br><span class="line">b    <span class="number">2</span>   <span class="number">10</span></span><br><span class="line">c    <span class="number">4</span>   <span class="number">12</span></span><br><span class="line">   one  two  four</span><br><span class="line">a    <span class="number">0</span>    <span class="number">8</span>     <span class="number">1</span></span><br><span class="line">b    <span class="number">2</span>   <span class="number">10</span>     <span class="number">2</span></span><br><span class="line">c    <span class="number">4</span>   <span class="number">12</span>     <span class="number">3</span></span><br><span class="line">   one  two  four</span><br><span class="line">a    <span class="number">0</span>    <span class="number">8</span>     <span class="number">1</span></span><br><span class="line">b    <span class="number">2</span>   <span class="number">10</span>     <span class="number">2</span></span><br><span class="line">c    <span class="number">4</span>   <span class="number">12</span>     <span class="number">3</span></span><br><span class="line">d    <span class="number">1</span>    <span class="number">2</span>     <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>【例】对于如下DataFrame数据，请利用Python将第三行数据替换成【9，10，11】</p>
<p>【解】用pandas的<strong>iloc【index】办法</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">d = &#123;<span class="string">&#x27;one&#x27;</span>:pd.Series([<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]),<span class="string">&#x27;two&#x27;</span>:pd.Series([<span class="number">8</span>,<span class="number">10</span>,<span class="number">12</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>])&#125;</span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line">df.insert(<span class="number">2</span>,<span class="string">&#x27;four&#x27;</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">df.loc[<span class="string">&quot;d&quot;</span>]=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df.iloc[<span class="number">2</span>]=[<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>]</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment">##结果</span></span><br><span class="line">   one  two  four</span><br><span class="line">a    <span class="number">0</span>    <span class="number">8</span>     <span class="number">1</span></span><br><span class="line">b    <span class="number">2</span>   <span class="number">10</span>     <span class="number">2</span></span><br><span class="line">c    <span class="number">4</span>   <span class="number">12</span>     <span class="number">3</span></span><br><span class="line">d    <span class="number">1</span>    <span class="number">2</span>     <span class="number">3</span></span><br><span class="line">   one  two  four</span><br><span class="line">a    <span class="number">0</span>    <span class="number">8</span>     <span class="number">1</span></span><br><span class="line">b    <span class="number">2</span>   <span class="number">10</span>     <span class="number">2</span></span><br><span class="line">c    <span class="number">9</span>   <span class="number">10</span>    <span class="number">11</span></span><br><span class="line">d    <span class="number">1</span>    <span class="number">2</span>     <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>三、数据删除、清理空格</p>
<p>【例】对于如下DataFrame数据，形式如下，请利用python删除下面DataFrame实例的第四列数据</p>
<p>【解】用drop函数，drop（’列名’,axis=1,inplace=false)</p>
<p>删除行：drop（‘行名’，axis=0，inplace=false）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">d = &#123;&#x27;one&#x27;:pd.Series([0,2,4],index=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;]),&#x27;two&#x27;:pd.Series([8,10,12],index=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;])&#125;</span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line">df.insert(2,&#x27;four&#x27;,[1,2,3])</span><br><span class="line">df.loc[&quot;d&quot;]=[1,2,3]</span><br><span class="line">print(df)</span><br><span class="line">df1 = df.drop(&#x27;four&#x27;,axis = 1,inplace=False)</span><br><span class="line">print(df1)</span><br><span class="line">##结果</span><br><span class="line">======================== RESTART: D:/PYTHON/10-17.py ========================</span><br><span class="line">   one  two  four</span><br><span class="line">a    0    8     1</span><br><span class="line">b    2   10     2</span><br><span class="line">c    4   12     3</span><br><span class="line">d    1    2     3</span><br><span class="line">   one  two</span><br><span class="line">a    0    8</span><br><span class="line">b    2   10</span><br><span class="line">c    4   12</span><br><span class="line">d    1    2</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>四、清理数据空格</p>
<p>【例】对于以下含有空格的字符串“北京，西城区，后海北沿， 46号”，请利用python去除空格，空白或空行。</p>
<p>【解】用python的strip()函数，在使用函数前要对字符串进行划分操作</p>
<p><em>默认情况下,函数strip()将删除字符串开头和结尾的空格</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">target = <span class="string">&#x27;北京，西城区，后海北沿， 46号&#x27;</span></span><br><span class="line">result=[val.strip() <span class="keyword">for</span> val <span class="keyword">in</span> target.split(<span class="string">&#x27;，&#x27;</span>)]</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment">##结果</span></span><br><span class="line">[<span class="string">&#x27;北京&#x27;</span>, <span class="string">&#x27;西城区&#x27;</span>, <span class="string">&#x27;后海北沿&#x27;</span>, <span class="string">&#x27;46号&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>五、清理数据中的空行</p>
<p>【例】对于给定的存储在d盘的文本数据集python_into2.txt,其内容形式如下，请利用python识别数据集中的空行并删除，然后重新保存在数据集python_into3.txt中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;d:/大数据/items/10-17.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">w = <span class="built_in">open</span>(<span class="string">&quot;d:/大数据/items/10-17(1).txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">data = f.readlines()</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">if</span> line.split():</span><br><span class="line">        w.writelines(line)</span><br><span class="line">f.close()</span><br><span class="line">w.close()</span><br></pre></td></tr></table></figure>

<h3 id="第八节、要点解析（1）"><a href="#第八节、要点解析（1）" class="headerlink" title="第八节、要点解析（1）"></a>第八节、要点解析（1）</h3><p>在获取到数据集之后，需要查看数据的基本情况，如数据类型、数据维度大小、数据特征分布。在掌握数据基本情况后，可以对数据进行预处理、如对缺失的数据进行检查和填充，对重复数据的检测和删除，对噪声数据进行简单的增加、删除、修改等操作，具体来讲：</p>
<ol>
<li>数据类型，非空值和内存使用情况，用py自带的info（）函数，也可以用type（）函数</li>
<li>数据维度大小，可以用py的shape属性查看</li>
<li>数据特征分布，平均值，标准差，最大值，最小值，分位数，用describe函数</li>
<li>缺失数据的检查，用py的isnull（）方法，缺失数据填充，不多时用fillna（）方法，缺失值多了，用均值填补法，插值填补法。</li>
<li>重复数据检测，py自带的去除冗余数据检测方法：duplicated（），而对于重复数据的删除，则可以用py自带的drop方法。</li>
<li>异常数据的检测，往往需要借助条件判断，和统计图形，异常数据删除用drop（）方法。</li>
<li>添加索引，对于series格式数据，可以用index参数进行设置，对于dataframe数据，可以利用index_col参数进行设置，对于重置索引，可以用set_index（）方法来设置；对于重命名索引，可以用reset_index()方法设定。</li>
<li>数据的增加，可以利用py的insert（）函数对dataframe实例增加数据。</li>
<li>数据的删除，可以用python提供的drop（）函数对指定的行，列进行删除操作。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hatiii.github.io/2022/12/12/Data%20Clean/" data-id="clbkgvq7p0000y8a803k0een3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/data-science/" rel="tag">data science</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2022/12/12/MY-Pet-University/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">MY Pet University</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/data-science/" rel="tag">data science</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/humster/" rel="tag">humster</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/data-science/" style="font-size: 10px;">data science</a> <a href="/tags/humster/" style="font-size: 10px;">humster</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/12/12/Data%20Clean/">Data clean</a>
          </li>
        
          <li>
            <a href="/2022/12/12/MY-Pet-University/">MY Pet University</a>
          </li>
        
          <li>
            <a href="/2022/12/11/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 哈提<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>